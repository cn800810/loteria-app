<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Loteria</title>

<style>
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto}
body{margin:0;background:#f2f2f2;height:100vh;display:flex;flex-direction:column}

/* ===== 顶部 ===== */
.header{
  background:#fff;border-bottom:1px solid #ddd;
  padding:6px 15px;
  display:grid;
  grid-template-columns:60px 1fr 60px;
  align-items:center;
}
.header span{color:#007aff;font-size:16px}
.header-center{text-align:center;line-height:1.3}
.header-center .title{font-size:17px;font-weight:600}
.header-center .sub{font-size:12px;color:#666}

/* ===== 中间记录区（关键） ===== */
.record-area{
  flex:1;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  padding:10px;
  color:#333;
  font-size:14px;
}
.record-list{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:6px;
}
.record-item{
  background:#fff;
  border-radius:6px;
  padding:6px;
  text-align:center;
  font-size:13px;
}

/* ===== 底部 ===== */
.bottom{background:#e6e6e6;padding:8px}
.control-grid{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:8px;
}

/* 通用按钮 */
.btn{
  border:none;border-radius:6px;
  font-size:15px;padding:10px;
}
.gray{background:#d0d0d0;color:#333}
.red{background:#ff0000;color:#fff}
.green{background:#2ecc71;color:#fff}
.blue{background:#007aff;color:#fff}

.left-col,.mid-col,.right-col{
  display:flex;flex-direction:column;gap:8px
}

.input-box{
  height:42px;border-radius:6px;border:1px solid #ccc;
  padding:0 8px;font-size:15px
}

.total{
  height:42px;border-radius:6px;
  background:#fff;display:flex;align-items:center;justify-content:center;
  font-size:18px;font-weight:bold;color:#ff0000
}

.confirm{flex:1;font-size:18px}
</style>
</head>

<body>

<!-- 顶部 -->
<div class="header">
  <span>记录</span>
  <div class="header-center">
    <div class="title">Loteria</div>
    <div class="sub" id="period"></div>
  </div>
  <span style="text-align:right">设置</span>
</div>

<!-- 中间显示区 -->
<div class="record-area" id="recordArea">
  <div class="record-list" id="recordList"></div>
</div>

<!-- 底部 -->
<div class="bottom">
  <div class="control-grid">

    <div class="left-col">
      <input id="input" class="input-box"
        type="tel" inputmode="numeric" pattern="[0-9]*" />
      <button id="digitBtn" class="btn gray">2位数</button>
      <div id="total" class="total">$0</div>
    </div>

    <div class="mid-col">
      <button id="modeBtn" class="btn gray">号码 / 数量</button>
      <button class="btn red">打印</button>
      <button class="btn gray">全部清除</button>
    </div>

    <div class="right-col">
      <button class="btn green">电子单</button>
      <button id="confirmBtn" class="btn blue confirm">确认</button>
    </div>

  </div>
</div>

<script>
/* ===== 日期 ===== */
const operatorName="Andy";
document.getElementById("period").innerText =
  `${new Date().toISOString().slice(0,10)}［${operatorName}］`;

/* ===== 元素 ===== */
const input = document.getElementById("input");
const recordList = document.getElementById("recordList");
const recordArea = document.getElementById("recordArea");

/* ===== 只允许数字 ===== */
input.addEventListener("input",()=>{
  input.value=input.value.replace(/\D/g,'');
});

/* ===== 输入框聚焦时，显示区保持可见（关键） ===== */
input.addEventListener("focus",()=>{
  recordArea.scrollIntoView({block:"end"});
});

/* ===== 防止按钮抢焦点 ===== */
function keepKeyboard(btn){
  ["mousedown","touchstart"].forEach(e=>{
    btn.addEventListener(e,ev=>ev.preventDefault(),{passive:false});
  });
}

/* ===== 2 / 4 位数 ===== */
let digit=2;
const digitBtn=document.getElementById("digitBtn");
keepKeyboard(digitBtn);
digitBtn.onclick=()=>{
  digit=digit===2?4:2;
  digitBtn.innerText=digit+"位数";
};

/* ===== 号码 / 数量 ===== */
let mode=0;
const modeBtn=document.getElementById("modeBtn");
keepKeyboard(modeBtn);
modeBtn.onclick=()=>{
  mode=mode===0?1:0;
  modeBtn.innerText=mode===0?"号码 / 数量":"数量 / 号码";
};

/* ===== 添加记录 ===== */
function addRecord(){
  const v=input.value;
  if(!v)return;

  let num,qty;
  if(mode===0){
    num=v.slice(0,digit);
    qty=v.slice(digit);
  }else{
    qty=v.slice(0,v.length-digit);
    num=v.slice(-digit);
  }
  if(!num||!qty)return;

  const div=document.createElement("div");
  div.className="record-item";
  div.innerText=`-${num}- | ${qty}`;
  recordList.appendChild(div);

  input.value="";
  recordArea.scrollTop=recordArea.scrollHeight;
  input.focus();
}

/* ===== 确认按钮 ===== */
const confirmBtn=document.getElementById("confirmBtn");
keepKeyboard(confirmBtn);
confirmBtn.onclick=addRecord;

/* ===== 键盘完成 = 确认 ===== */
input.addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    e.preventDefault();
    addRecord();
  }
});
</script>

</body>
</html>
