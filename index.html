<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport"
  content="width=device-width,
           initial-scale=1.0,
           maximum-scale=1.0,
           user-scalable=no"/>

<title>Loteria</title>

<style>
*{
  box-sizing:border-box;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto
}
body{
  margin:0;
  background:#f2f2f2;
  height:100vh;
  display:flex;
  flex-direction:column;
}

/* ===== 顶部 ===== */
.header{
  background:#fff;
  border-bottom:1px solid #ddd;
  padding:6px 15px;
  display:grid;
  grid-template-columns:60px 1fr 60px;
  align-items:center;
}
.header span{
  color:#007aff;
  font-size:16px;
}
.header-center{
  text-align:center;
  line-height:1.3;
}
.header-center .title{
  font-size:17px;
  font-weight:600;
}
.header-center .sub{
  font-size:12px;
  color:#666;
}

/* ===== 中间记录区 ===== */
.record-area{
  flex:1;
  padding:10px;
  overflow-y:auto;
  font-size:14px;
  color:#333;
  background:#f2f2f2;
}
.record-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
}
.record-item{
  background:#fff;
  border-radius:6px;
  padding:6px;
  text-align:center;
  font-size:14px;
}

/* ===== 底部 ===== */
.bottom{
  background:#e6e6e6;
  padding:8px;
}
.control-grid{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:8px;
}

/* 通用按钮 */
.btn{
  border:none;
  border-radius:6px;
  font-size:15px;
  padding:10px;
}
.gray{background:#d0d0d0;color:#333}
.red{background:#ff0000;color:#fff}
.green{background:#2ecc71;color:#fff}
.blue{background:#007aff;color:#fff}

/* 列布局 */
.left-col,.mid-col,.right-col{
  display:flex;
  flex-direction:column;
  gap:8px;
}

/* 输入 */
.input-box{
  height:42px;
  border-radius:6px;
  border:1px solid #ccc;
  padding:0 8px;
  font-size:15px;
}

/* 合计 */
.total{
  height:42px;
  border-radius:6px;
  background:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
  font-weight:bold;
  color:#ff0000;
}

/* 确认按钮更大 */
.confirm{
  flex:1;
  font-size:18px;
}
</style>
</head>

<body>

<!-- 顶部 -->
<div class="header">
  <span>记录</span>
  <div class="header-center">
    <div class="title">Loteria</div>
    <div class="sub" id="period"></div>
  </div>
  <span style="text-align:right">设置</span>
</div>

<!-- 下单显示区 -->
<div class="record-area" id="recordArea">
  <div class="record-grid" id="recordGrid"></div>
</div>

<!-- 底部 -->
<div class="bottom">
  <div class="control-grid">

    <!-- 左列 -->
    <div class="left-col">
      <input
        id="input"
        class="input-box"
        type="tel"
        inputmode="numeric"
        pattern="[0-9]*"
      />
      <button id="digitBtn" class="btn gray">2位数</button>
      <div id="total" class="total">$0</div>
    </div>

    <!-- 中列 -->
    <div class="mid-col">
      <button id="modeBtn" class="btn gray">号码 / 数量</button>
      <button class="btn red">打印</button>
      <button class="btn gray">全部清除</button>
    </div>

    <!-- 右列 -->
    <div class="right-col">
      <button class="btn green">电子单</button>
      <button id="confirmBtn" class="btn blue confirm">确认</button>
    </div>

  </div>
</div>

<script>
/* ===== 日期 ===== */
const operatorName = "Andy";
const today = new Date().toISOString().slice(0,10);
document.getElementById("period").innerText =
  `${today}［${operatorName}］`;

/* ===== 状态 ===== */
let digit = 2;      // 2 or 4
let mode = 0;       // 0: 号码/数量, 1: 数量/号码

const input = document.getElementById("input");
const recordGrid = document.getElementById("recordGrid");

/* ===== 只允许数字 ===== */
input.addEventListener("input", () => {
  input.value = input.value.replace(/\D/g,'');
});

/* ===== 输入时始终滚到记录区（关键） ===== */
input.addEventListener("focus", () => {
  setTimeout(() => {
    document.getElementById("recordArea")
      .scrollIntoView({ behavior:"smooth", block:"start" });
  }, 300);
});

/* ===== 防止按钮抢焦点，保持键盘 ===== */
function keepKeyboard(btn){
  btn.addEventListener("touchstart", e => {
    e.preventDefault();
    input.focus();
  }, { passive:false });

  btn.addEventListener("mousedown", e => {
    e.preventDefault();
    input.focus();
  });
}

/* ===== 2 / 4 位数 ===== */
const digitBtn = document.getElementById("digitBtn");
keepKeyboard(digitBtn);
digitBtn.onclick = () => {
  digit = digit === 2 ? 4 : 2;
  digitBtn.innerText = digit + "位数";
};

/* ===== 号码 / 数量 ===== */
const modeBtn = document.getElementById("modeBtn");
keepKeyboard(modeBtn);
modeBtn.onclick = () => {
  mode = mode === 0 ? 1 : 0;
  modeBtn.innerText =
    mode === 0 ? "号码 / 数量" : "数量 / 号码";
};

/* ===== 确认 ===== */
const confirmBtn = document.getElementById("confirmBtn");
keepKeyboard(confirmBtn);

function confirmInput(){
  const val = input.value;
  if(!val) return;

  let number = "";
  let qty = "";

  if(mode === 0){ // 号码 / 数量
    number = val.slice(0, digit);
    qty = val.slice(digit);
  }else{          // 数量 / 号码
    qty = val.slice(0, val.length - digit);
    number = val.slice(-digit);
  }

  if(!qty || Number(qty) <= 0) return;

  const div = document.createElement("div");
  div.className = "record-item";
  div.innerText = `-${number}- | ${qty}`;
  recordGrid.appendChild(div);

  input.value = "";
}

confirmBtn.onclick = confirmInput;

/* 回车 / 完成 = 确认 */
input.addEventListener("keydown", e => {
  if(e.key === "Enter"){
    e.preventDefault();
    confirmInput();
    input.focus();
  }
});
</script>

</body>
</html>
